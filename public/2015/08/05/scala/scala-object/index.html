<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>对象 | Wiki</title>
  <meta name="author" content="Jassassin">
  
  <meta name="description" content="类简单类定义Scala中类的定义比较简单:class不需要public修饰，同一个源文件中可同时定义多个class,并且这些类都是公开的。
12345678910class Counter &amp;#123;  private var value = 0    def increment() &amp;#123;">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="对象"/>
  <meta property="og:site_name" content="Wiki"/>

  
    <meta property="og:image" content="undefined"/>
  

  
    <link rel="alternative" href="/atom.xml" title="Wiki" type="application/atom+xml">
  
  
    <link href="/favicon.ico" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">  
  <link rel="stylesheet" href="/css/sidenav.css" media="screen" type="text/css">  
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  

</head>

<body id="body" data-spy="scroll" data-target=".toc">
  <div class="container" id="container">
	<div class="content">
	  <div class="page-header">		
  <h1><a class="brand" href="/">Wiki</a><span class="split"></span><span class="title">对象</span><span class="date" id="title-date"><i class="fa fa-clock-o"></i> 2015-08-05</span></h1>
</div>		

<div class="row page">
  <!-- cols -->	
  
  <div class="col-xs-12 col-sm-3 col-md-3 toc"> 
	<!-- toc -->
<script type="text/javascript">
		jQuery(document).ready(function() {
 		   generateWikiTOC('.note', '.toc',  2 , 2 );
		});
</script>
  </div><!-- col-md-3 -->
  
  

  
  <div class="col-xs-12 col-sm-9 col-md-9 note">
	

	  <!-- content -->
	  <h2 id="类">类</h2><h3 id="简单类定义">简单类定义</h3><p>Scala中类的定义比较简单:class不需要<code>public</code>修饰，同一个源文件中可同时定义多个<code>class</code>,并且这些类都是公开的。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> &#123;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> value = <span class="number">0</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">increment</span>(</span>) &#123;</span><br><span class="line">    value += <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">current</span>(</span>) = value</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>调用:scala中对于不含参数的方法，则可以省略后面的括号。一般建议取值操作建议去掉空格!<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Demo</span>&#123;</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span>(</span>args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">var</span> obj1 = <span class="keyword">new</span> <span class="type">Counter</span></span><br><span class="line">     obj1.increment</span><br><span class="line">     println(obj1.current)</span><br><span class="line">     </span><br><span class="line"><span class="comment">//   var obj1 = new Counter()</span></span><br><span class="line"><span class="comment">//   obj1.increment()</span></span><br><span class="line"><span class="comment">//   println(obj1.current())</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">输出: <span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<h3 id="getter_setter方法">getter_setter方法</h3><p>scala对每个字段都提供getter和setter方法，将下面的代码保存为Person.scala:<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line">    <span class="keyword">var</span> age = <span class="number">10</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>编译成JVM字节码文件:<code>scalac Person.scala</code>.通过<code>javap -private Person.class</code>查看翻译后的java代码:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Compiled from <span class="string">"Person.scala"</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="comment">//属性字段</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//由scala自动生成的getter/setter方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">age</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> age_$eq(<span class="keyword">int</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//构造方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>通过上面的java代码可以发现，翻译后的scala字段get/set方法并不是直接getXXX()/setXXX()！<br>scala中如果字段是私有的，则生成的getter/setter方法也是私有。因此，如果想自定义scala的get/set方法则可以将字段设置为<code>private</code>修饰的:<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line">	<span class="comment">//生成私有getter/setter</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">var</span> privateAge = <span class="number">10</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//val修饰的只生成getter</span></span><br><span class="line">	<span class="function"><span class="keyword">val</span> <span class="title">name</span> =</span> <span class="string">"eagle"</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//不生成getter/setter</span></span><br><span class="line">       <span class="keyword">private</span>[<span class="keyword">this</span>] <span class="keyword">var</span> sex = <span class="string">"man"</span> </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//自定义get/set</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">age</span> =</span> privateAge</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">setAge</span>(</span>newVal: <span class="type">Int</span>)&#123;</span><br><span class="line">		privateAge = newVal	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>编译成JVM字节码文件:<code>scalac Person.scala</code>.通过<code>javap -private Person.class</code>查看翻译后的java代码:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Compiled from <span class="string">"Person.scala"</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> privateAge;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> java.lang.String name;</span><br><span class="line">  <span class="comment">//未生成任何get/set方法</span></span><br><span class="line">  <span class="keyword">private</span> java.lang.String sex;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//private</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">privateAge</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> privateAge_$eq(<span class="keyword">int</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//val</span></span><br><span class="line">  <span class="keyword">public</span> java.lang.<span class="function">String <span class="title">name</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//自定义方法get/set</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">age</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>注: 关于scala中字段自动生成setter/getter方法规则</p>
<ul>
<li>如果字段是私有的(private)，则编译生成的class文件中的getter/setter方法也是私有的</li>
<li>如果字段是val的，则只生成getter方法</li>
<li>如果不想生成任何getter/setter方法，则可以使用private[this]修饰</li>
</ul>
<h3 id="Bean属性">Bean属性</h3><p>由前面的介绍可知，虽然scala自动为属性字段生成了getter/setter方法，但是这些方法并不符合javabean规范。但是你可以通过scala提供的<code>@BeanProperty</code>来实现符合javabean规范的getter/setter方法:<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scala.reflect.<span class="type">BeanProperty</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>&#123;</span></span><br><span class="line">	<span class="annotation">@BeanProperty</span> <span class="keyword">var</span> name: <span class="type">String</span> = <span class="string">"eagle"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>class文件:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Compiled from <span class="string">"Person.scala"</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> java.lang.String name;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> java.lang.<span class="function">String <span class="title">name</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> name_$eq(java.lang.String);</span><br><span class="line">	</span><br><span class="line">  <span class="comment">//@BeanProperty生成的符合规范的getter/setter方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(java.lang.String)</span></span>;</span><br><span class="line">  <span class="keyword">public</span> java.lang.<span class="function">String <span class="title">getName</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="主构造器">主构造器</h3><p>在scala中每个类都有主构造器，主构造器并不是以this方法定义，而是与类定义交织在一起:</p>
<ul>
<li>主构造器参数直接放在类名之后,主构造器参数会被编译成字段，其值被初始化成构造时传入的参数。</li>
<li>主构造器会执行类定义中的所有语句</li>
<li>通常在定义主构造器时同时指定默认参数</li>
<li>如果类名之后没有参数，则该类则具备一个无参主构造器。这样一个构造器会执行类体重的所有语句</li>
<li><p>构造参数也可以是不带val或var修饰，这样的参数如何处理则取决于它们在类中如何被使用.如果该参数至少被类中一个方法所使用，则该参数将被初始化不可变的私有为字段,效果类似<code>private[this] val</code>。否则，该参数将不被保存为字段!</p>
</li>
<li><p>主构造器可以由<code>private</code>关键字修饰，这样主构造器就变成私有了，而用户就只能调用该类的辅助构造器了</p>
</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(</span><span class="keyword">var</span> name: <span class="type">String</span>,<span class="function"><span class="keyword">val</span> <span class="title">age</span>:</span> <span class="type">Int</span>)&#123;</span><br><span class="line">	println(<span class="string">"name:"</span> + name + <span class="string">",age:"</span> + age)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Person</span>&#123;</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span>(</span>args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">new</span> <span class="type">Person</span>(<span class="string">"jack"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">输出:name=jack,age=<span class="number">30</span> --&gt;</span><br></pre></td></tr></table></figure>
<p><code>javap -private Person.class</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">com</span>.<span class="title">jassassin</span>.<span class="title">scala</span>.<span class="title">chaptor567</span>.<span class="title">Person</span> <span class="keyword">extends</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Object</span></span>&#123;</span><br><span class="line">    <span class="comment">//字段</span></span><br><span class="line">    <span class="keyword">private</span> java.lang.String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置默认值</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> $lessinit$greater$<span class="keyword">default</span>$<span class="number">2</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> java.lang.String $lessinit$greater$<span class="keyword">default</span>$<span class="number">1</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//scala自动生成的name的getter/setter方法</span></span><br><span class="line">    <span class="keyword">public</span> java.lang.<span class="function">String <span class="title">name</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> name_$eq(java.lang.String);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//val类型的age字段只生成getter方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">age</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//主构造函数</span></span><br><span class="line">    <span class="keyword">public</span> com.jassassin.scala.chaptor567.Person(java.lang.String, <span class="keyword">int</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>构造参数不带<code>var</code>或<code>val</code>,被类中函数使用:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jassassin.scala.chaptor567</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(</span>name: <span class="type">String</span> = <span class="string">"eagle"</span>,age: <span class="type">Int</span> = <span class="number">30</span>) &#123;</span><br><span class="line">  <span class="comment">//description函数使用到了主构造参数，则该参数被升格为私有字段。效果类似private[this] val</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">description</span> =</span> <span class="string">"name="</span> + name + <span class="string">",age="</span> + age</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//javap:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">com</span>.<span class="title">jassassin</span>.<span class="title">scala</span>.<span class="title">chaptor567</span>.<span class="title">Person</span> <span class="keyword">extends</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Object</span></span>&#123;</span><br><span class="line">    <span class="comment">//私有final</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> java.lang.String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> $lessinit$greater$<span class="keyword">default</span>$<span class="number">2</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> java.lang.String $lessinit$greater$<span class="keyword">default</span>$<span class="number">1</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//函数</span></span><br><span class="line">    <span class="keyword">public</span> java.lang.<span class="function">String <span class="title">description</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> com.jassassin.scala.chaptor567.Person(java.lang.String, <span class="keyword">int</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>构造参数不带<code>var</code>或<code>val</code>，未在类中使用:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(</span>name: <span class="type">String</span>,age: <span class="type">Int</span>) &#123;</span><br><span class="line"><span class="comment">//  def description = "name=" + name + ",age=" + age</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//javap:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">com</span>.<span class="title">jassassin</span>.<span class="title">scala</span>.<span class="title">chaptor567</span>.<span class="title">Person</span> <span class="keyword">extends</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Object</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> com.jassassin.scala.chaptor567.Person(java.lang.String, <span class="keyword">int</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>主构造器由<code>private</code>关键字修饰</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="title">private</span>(</span><span class="keyword">var</span> name: <span class="type">String</span>,<span class="function"><span class="keyword">val</span> <span class="title">age</span>:</span> <span class="type">Int</span>)&#123;</span><br><span class="line">	 </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//javap</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> java.lang.String name;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> age;</span><br><span class="line">  <span class="keyword">public</span> java.lang.<span class="function">String <span class="title">name</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> name_$eq(java.lang.String);</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">age</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//注意私有构造方法</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">Person</span><span class="params">(java.lang.String, <span class="keyword">int</span>)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="辅助构造器">辅助构造器</h3><p>和Java和C++一样,Scala也可以有任意多的构造器.不过Scala中只有前面所述的一个主构造器以及任意多个辅助构造器.这些辅助构造器有以下几个特点:</p>
<ul>
<li>Scala中的辅助构造器的名称都是this</li>
<li>每个辅助构造器都必须以一个对先前已定义的其他辅助构造器或主构造器的调用开始</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">var</span> name = <span class="string">"eagle"</span> </span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">var</span> age = <span class="number">20</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">this</span>(</span>name: <span class="type">String</span>)&#123;</span><br><span class="line">		<span class="keyword">this</span>()</span><br><span class="line">		<span class="keyword">this</span>.name = name	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">this</span>(</span>name: <span class="type">String</span>,age: <span class="type">Int</span>)&#123;</span><br><span class="line">		<span class="keyword">this</span>(name)</span><br><span class="line">		<span class="keyword">this</span>.age = age	</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//javap</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> java.lang.String name;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">  <span class="keyword">private</span> java.lang.<span class="function">String <span class="title">name</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> name_$eq(java.lang.String);</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">age</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> age_$eq(<span class="keyword">int</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//三个构造器</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(java.lang.String)</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(java.lang.String, <span class="keyword">int</span>)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="嵌套类">嵌套类</h3><p>Scala中可以定义类似java中的内部类,而且scala中的嵌套类有着自己的特点.先看下面的示例:<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jassassin.blog.scala.demo.chaptor5</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> scala.collection.mutable.<span class="type">ArrayBuffer</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * 嵌套类</span><br><span class="line"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Company</span>(</span><span class="keyword">var</span> name: <span class="type">String</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 公司部门</span><br><span class="line">     */</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Department</span>(</span><span class="keyword">var</span> name: <span class="type">String</span>)&#123;</span><br><span class="line">      <span class="function"><span class="keyword">val</span> <span class="title">members</span> =</span> <span class="keyword">new</span> <span class="type">ArrayBuffer</span>[<span class="type">String</span>]</span><br><span class="line">    &#125; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 公司所有部门</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">val</span> <span class="title">departments</span> =</span> <span class="keyword">new</span> <span class="type">ArrayBuffer</span>[<span class="type">Department</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 为该公司添加部门</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">join</span>(</span>dep: <span class="type">Department</span>) = &#123;</span><br><span class="line">      departments += dep</span><br><span class="line">      dep</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Company</span>&#123;</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span>(</span>args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">      <span class="function"><span class="keyword">val</span> <span class="title">networkbench</span> =</span> <span class="keyword">new</span> <span class="type">Company</span>(<span class="string">"networkbench"</span>)</span><br><span class="line">      <span class="function"><span class="keyword">val</span> <span class="title">embracesource</span> =</span> <span class="keyword">new</span> <span class="type">Company</span>(<span class="string">"embracesource"</span>)</span><br><span class="line">      </span><br><span class="line">      <span class="function"><span class="keyword">val</span> <span class="title">dev1</span> =</span> <span class="keyword">new</span> networkbench.<span class="type">Department</span>(<span class="string">"dev1"</span>)</span><br><span class="line">      <span class="function"><span class="keyword">val</span> <span class="title">dev12</span> =</span> <span class="keyword">new</span> networkbench.<span class="type">Department</span>(<span class="string">"dev12"</span>)</span><br><span class="line">      </span><br><span class="line">      <span class="function"><span class="keyword">val</span> <span class="title">ops</span> =</span> <span class="keyword">new</span> embracesource.<span class="type">Department</span>(<span class="string">"ops"</span>)</span><br><span class="line">      </span><br><span class="line">      networkbench.join(dev1)</span><br><span class="line">      networkbench.join(dev12)</span><br><span class="line">       </span><br><span class="line">       <span class="comment">//注意这里添加了一个属于embracesource的部门</span></span><br><span class="line">      networkbench.join(ops)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>scalac Company.scala</code>编译,错误提示:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> Company.scala:<span class="number">45</span>: error: type mismatch;</span><br><span class="line"> found   : embracesource.Department</span><br><span class="line"> required: networkbench.Department</span><br><span class="line">      networkbench.join(ops)</span><br><span class="line">                        ^</span><br><span class="line">one error found</span><br></pre></td></tr></table></figure></p>
<p>上面错误提示networkbench不能添加embracesource的部门原因在于<code>scala中每个Company实例都有它自己的Department.</code>也就是说networkbench.Department和embracesource.Department是两个不同的数据类型!</p>
<h4 id="类型投影">类型投影</h4><p>如果想产生类似java中的内部类特性,则可以将Department移至Company的外部.或者可以使用<code>类型投影 Company#Department</code>即”任何Company的Department”!<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Company</span>(</span><span class="keyword">var</span> name: <span class="type">String</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 公司部门</span><br><span class="line">     */</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Department</span>(</span><span class="keyword">var</span> name: <span class="type">String</span>)&#123;</span><br><span class="line">      <span class="function"><span class="keyword">val</span> <span class="title">members</span> =</span> <span class="keyword">new</span> <span class="type">ArrayBuffer</span>[<span class="type">String</span>]</span><br><span class="line">    &#125; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 公司所有部门</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">val</span> <span class="title">departments</span> =</span> <span class="keyword">new</span> <span class="type">ArrayBuffer</span>[<span class="type">Company</span>#<span class="type">Department</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 为该公司添加部门</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">join</span>(</span>dep: <span class="type">Company</span>#<span class="type">Department</span>) = &#123;</span><br><span class="line">      departments += dep</span><br><span class="line">      dep</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="对象">对象</h2><p>当你需要某个类的单个实例，或者想为其他值或函数找一个可以挂靠的地方时，那么你可以考虑scala object语法。</p>
<h3 id="单例对象">单例对象</h3><p>Scala没有静态方法或静态字段，但你可以用object语法来达到同样的目的<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">object Object &#123;</span><br><span class="line">  <span class="function">def <span class="title">main</span><span class="params">(args: Array[String])</span>: Unit </span>= &#123;</span><br><span class="line">      <span class="comment">//连续调用5次</span></span><br><span class="line">      <span class="keyword">for</span>(i &lt;- <span class="number">1</span> to <span class="number">5</span>)&#123;</span><br><span class="line">          println(Accounts.newUniqueNumber())</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * object 类型</span><br><span class="line"> */</span></span><br><span class="line">object Accounts&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> var lastNumber = <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span><br><span class="line">   * 用于产生一个唯一number</span><br><span class="line">   */</span></span><br><span class="line">  <span class="function">def <span class="title">newUniqueNumber</span><span class="params">()</span> </span>= &#123;</span><br><span class="line">    lastNumber += <span class="number">1</span></span><br><span class="line">    lastNumber</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>示例中的<code>Accounts</code>,只会在该类第一次使用时被初始化一次也就是说如果该类从未被使用，则其构造器也不会被执行。对于任何你在Java或C++中会使用单例对象的地方，在Scala中都可以用对象来实现(但不能提供构造器参数):</p>
<ul>
<li>存放工具函数或常量</li>
<li>共享单个不可变实例</li>
<li>需要用单个实例来协调某个服务时</li>
</ul>
<h3 id="伴生对象">伴生对象</h3><p>在Java或C++中，通常会用到既有实例方法又有静态方法的类。在Scala中，你可以通过类和与类同名的”伴生”对象来达到同样的目的。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> * object 类型</span><br><span class="line"> * Accounts类的伴生对象</span><br><span class="line"> */</span></span><br><span class="line">object Accounts&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> var lastNumber = <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span><br><span class="line">   * 用于产生一个唯一number</span><br><span class="line">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> def <span class="title">newUniqueNumber</span><span class="params">()</span> </span>= &#123;</span><br><span class="line">    lastNumber += <span class="number">1</span></span><br><span class="line">    lastNumber</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Accounts</span></span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//这里访问伴生对象的私有方法</span></span><br><span class="line">  val id = Accounts.newUniqueNumber()</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> var balance = <span class="number">0.0</span></span><br><span class="line">  </span><br><span class="line">  <span class="function">def <span class="title">deposit</span><span class="params">(amount: Double)</span> </span>&#123;</span><br><span class="line">    balance += amount</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>当类和它的伴生对象在同个文件中时，类可以访问伴生对象的私有特性(虽有可以访问但是并不包含在类的作用域中，因此需要添加Accounts前缀)。</p>
<h2 id="包">包</h2><h2 id="继承">继承</h2>	  

	  <div>
  		<center>
		  <div class="pagination">
<ul class="pagination">
	
	
	
	
	
		
	
		
	
		
	
		
	
		
			
			
		
	
		
			
			
			
		
	
		
			
		
	
		
			
		
	
		
	
		
	
		
	
	
		<li class="prev disabled"><a><i class="fa fa-arrow-circle-o-left"></i>prev</a></li>
	
	<li><a href="/"><i class="fa fa-archive"></i>Home</a></li>
	
		<li class="next"><a href="/2015/08/05/scala/scala/" class="alignright next">next<i class="fa fa-arrow-circle-o-right"></i></a></li>
	
</ul>
</div>

		</center>
	  </div>
	  
	</div> <!-- col-md-9/col-md-12 -->
	
  </div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
	<footer> <p>
  &copy; 2016 Jassassin
  
      with help from <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-wixo/">Wixo</a>.    
</p> </footer>
  </div> <!-- container-narrow -->
  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.tableofcontents.min.js"></script>
<script src="/js/tocgenerator.min.js"></script>
<script src="/js/main.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
</html>
